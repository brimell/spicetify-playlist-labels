!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var o,s,c,u,p,d,e,t,i,f,m,n,l,y,r,a,v,g,h,b,S,A,x,w,P,E,L;o=Object.create,s=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,p=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,i=(e=(e,t)=>function(){return t||(0,e[u(e)[0]])((t={exports:{}}).exports,t),t.exports})({"external-global-plugin:react-dom"(e,t){t.exports=Spicetify.ReactDOM}}),f=(t=(e,t,i)=>{i=null!=e?o(p(e)):{};var l=!t&&e&&e.__esModule?i:s(i,"default",{value:e,enumerable:!0}),r=e,a=void 0,n=void 0;if(r&&"object"==typeof r||"function"==typeof r)for(let e of u(r))d.call(l,e)||e===a||s(l,e,{get:()=>r[e],enumerable:!(n=c(r,e))||n.enumerable});return l})(e({"external-global-plugin:react"(e,t){t.exports=Spicetify.React}})()),m=t(i()),n={},g=[],h=[],w=x=S=v=a=r=y=l=null,P=A=!(b={}),E=[],L=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));P=await JSON.parse(localStorage.getItem("spicetify-playlist-labels:show-all")||"false"),await Spicetify.Platform.RootlistAPI._events._emitter.addListener("update",()=>{R().then(e=>{[b,S]=e,k(),A=!0,I()})});var e=`<svg data-encore-id="icon" role="img" viewBox="0 0 16 16" class="Svg-img-icon-small">${Spicetify.SVGIcons.spotify}</svg>`,e=(new Spicetify.Playbar.Button("Show All Saved Playlists",e,e=>{e.active=P=!e.active,localStorage.setItem("spicetify-playlist-labels:show-all",JSON.stringify(P)),A=!0,I()},!1,P),[b,S]=await R(),k(),v=new MutationObserver(()=>{I()}),new MutationObserver(async()=>{await M()}));await M(),e.observe(document.body,{childList:!0,subtree:!0})},(async()=>{await L()})();function O(e){let i=[];return function t(e){"playlist"===e.type?i.push(e):"folder"===e.type&&e.items&&e.items.forEach(e=>t(e))}(e),i}async function R(){var e=await Spicetify.Platform.RootlistAPI.getContents();const l=O(e);var t=await Promise.all(l.map(e=>async function(e){return(await Spicetify.Platform.PlaylistAPI.getContents(e)).items}(e.uri)));const r=await Promise.all(l.map(e=>{var e=e.images;return 0===e.length?null:(e=e[0].url,n[e]||async function(e){var t,i,l=Spicetify.GraphQL.Definitions["fetchExtractedColors"];try{return null==(i=null==(t=(await Spicetify.GraphQL.Request(l,{uris:[e]})).data)?void 0:t.extractedColors)?void 0:i[0]}catch(e){return null}}(e))})),a=(r.forEach((e,t)=>{e&&(n[l[t].uri]=e)}),{});return t.forEach((e,i)=>{e.forEach(e=>{var t=e.uri;a[t]||(a[t]=[]),a[t].some(e=>e.uri===l[i].uri)||a[t].push({colorLight:null!=(t=null==(t=null==(t=r[i])?void 0:t.colorLight)?void 0:t.hex)?t:"",color:null!=(t=null==(t=null==(t=r[i])?void 0:t.colorRaw)?void 0:t.hex)?t:"",name:l[i].name,uri:l[i].uri,trackUid:e.uid,canEdit:l[i].canAdd&&l[i].canRemove,image:(null==(t=l[i].images[0])?void 0:t.url)||"",isMosaic:null!=(t=null==(e=l[i].images[0])?void 0:e.url.startsWith("spotify:mosaic"))&&t,isSpotifyPlaylist:"spotify:user:spotify"===l[i].owner.uri})})}),[a,e]}function C(e){return e.match(/spotify:playlist:(.*)/)[1]}function I(){var t;h=g;let i=(g=Array.from(document.querySelectorAll(".main-trackList-indexable"))).length!==h.length;for(let e=0;e<g.length;e++)g[e].isEqualNode(h[e])||(i=!0);i&&(y=l=null);const r=[null,null,null,null,"[index] 16px [first] 4fr [var1] 1fr [var2] 2fr [last] minmax(120px,1fr)","[index] 16px [first] 6fr [var1] 4fr [var2] 3fr [var3] 4fr [last] minmax(120px,1fr)","[index] 16px [first] 6fr [var1] 4fr [var2] 3fr [var3] minmax(120px,2fr) [var3] 2fr [last] minmax(120px,1fr)"];let a=null;document.querySelectorAll(".main-trackList-trackListHeaderRow").forEach(e=>{var t=e.querySelector(".main-trackList-rowSectionEnd"),t=parseInt(t.getAttribute("aria-colindex"));(l=l||getComputedStyle(e).gridTemplateColumns)&&r[t]&&(e.style.setProperty("grid-template-columns",r[t],"important"),a=r[t])});for(const e of g){for(const s of e.getElementsByClassName("main-trackList-trackListRow")){o=s,n=void 0;const c=(o=Object.values(o))?(null==(n=null==(o=null==(o=null==(o=null==(o=null==(o=o[0])?void 0:o.pendingProps)?void 0:o.children[0])?void 0:o.props)?void 0:o.children)?void 0:o.props)?void 0:n.uri)||(null==(n=null==(n=null==(n=null==o?void 0:o.props)?void 0:n.children)?void 0:n.props)?void 0:n.uri)||(null==(n=null==(n=null==(n=null==(n=null==(n=null==o?void 0:o.props)?void 0:n.children)?void 0:n.props)?void 0:n.children)?void 0:n.props)?void 0:n.uri)||(null==(o=null==(n=o[0])?void 0:n.props)?void 0:o.uri):null;x===c&&Spicetify.Platform.History.location.pathname===w&&(s.click(),x=null);let e=s.querySelector(".spicetify-playlist-labels");if(A&&e&&(e.remove(),e=null),!e){let l=function(e){return e.codePointAt(0)<=255||65281<=e.codePointAt(0)&&e.codePointAt(0)<=65374},i=function(e){var e=e.split(" "),t=e[0],e=1<e.length?e[1]:"",i=Array.from(t).slice(0,1).join(""),e=e?Array.from(e).slice(0,1).join(""):"";return i+(l(t.charAt(0))?e:"")};l,i;var n=s.querySelector(".main-trackList-rowSectionEnd"),o=parseInt(n.getAttribute("aria-colindex"));n.setAttribute("aria-colindex",(o+1).toString()),e=document.createElement("div");m.default.render(f.default.createElement("div",{className:"spicetify-playlist-labels-labels-container"},null==(t=b[c])?void 0:t.map(t=>{var e;return!P&&t.isSpotifyPlaylist||(e=C(t.uri),Spicetify.Platform.History.location.pathname==="/playlist/"+e)?null:f.default.createElement(Spicetify.ReactComponent.TooltipWrapper,{label:t.name,placement:"top"},f.default.createElement("div",{className:"spicetify-playlist-labels-label-container",style:{cursor:"pointer"},onClick:e=>{e.stopPropagation();e=null==(e=Spicetify.URI.fromString(t.uri))?void 0:e.toURLPath(!0);x=c,(w=e)&&Spicetify.Platform.History.push({pathname:e,search:"?uid="+t.trackUid})}},f.default.createElement("img",{width:"28px",style:{borderRadius:"4px",background:`linear-gradient(0deg, ${t.color}, ${t.colorLight})`},src:t.isMosaic?"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==":t.image}),t.isMosaic?f.default.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:14,textAlign:"center"}},i(t.name)):null))})),e),e.setAttribute("aria-colindex",o.toString()),e.role="gridcell",e.style.display="grid",e.classList.add("main-trackList-rowSectionVariable"),e.classList.add("spicetify-playlist-labels"),s.insertBefore(e,n),y=y||getComputedStyle(s).gridTemplateColumns,r[o]&&s.style.setProperty("grid-template-columns",a||r[o],"important")}}A=!1}}async function M(){r=a,(a=document.querySelector("main"))&&!a.isEqualNode(r)&&(r&&v.disconnect(),I(),v.observe(a,{childList:!0,subtree:!0}))}async function k(){for(;registeredMenu=E.pop();)registeredMenu.deregister();const t=new Spicetify.ContextMenu.SubMenu("Remove from playlist",[],function(e){return!Spicetify.URI.isTrack(e[0])||null==(e=b[e])?void 0:e.some(e=>{var t=C(e.uri);return e.canEdit&&Spicetify.Platform.History.location.pathname!=="/playlist/"+t})},!1);function a(e,t){if("folder"===t.type){const l=O(t),r=new Spicetify.ContextMenu.SubMenu(t.name,[],e=>{return b[e].some(t=>l.some(e=>e.uri===t.uri&&t.canEdit))},!1);e.addItem(r),t.items.forEach(e=>{a(r,e)}),void E.push(r)}else{var i;"playlist"===t.type&&t.canAdd&&t.canRemove&&(i=new Spicetify.ContextMenu.Item(t.name,e=>{!async function(e,t){await Spicetify.Platform.PlaylistAPI.remove(e,[{uri:t,uid:""}])}(t.uri,e),b[e]=b[e].filter(e=>e.uri!==t.uri),k(),A=!0,I()},e=>b[e].some(e=>e.uri===t.uri&&e.canEdit),null,!1),e.addItem(i),E.push(i))}}t._element.addEventListener("mouseenter",()=>{var e=document.querySelectorAll("[id*=tippy]");if(!(e.length<=1)){const t=e[e.length-1],i=(t.style.display="none",document.querySelectorAll(".main-contextMenu-menuItemButton[aria-expanded=true]")[0]);null!=i&&i.setAttribute("aria-expanded",!1),null!=i&&i.addEventListener("mouseenter",function e(){null!=i&&i.setAttribute("aria-expanded",!0),t.style.display="block",null!=i&&i.removeEventListener("mouseenter",e)})}}),t.register(),E.push(t),S.items.forEach(e=>{a(t,e)})}(async()=>{var e;document.getElementById("spicetifyDplaylistDlabels")||((e=document.createElement("style")).id="spicetifyDplaylistDlabels",e.textContent=String.raw`
  .spicetify-playlist-labels-labels-container{height:var(--row-height);align-items:center;display:flex;overflow:hidden;gap:5px}.spicetify-playlist-labels-label-container{position:relative;height:28px}.spicetify-playlist-labels-label-container>img{height:100%;-o-object-fit:cover;object-fit:cover}
      `.trim(),document.head.appendChild(e))})()}();